Handle enums and unions with code gen. 

Run `npm t` to see it in action